"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var http_1 = require("@angular/common/http");
var md5_1 = require("ts-md5/dist/md5");
require("rxjs/add/operator/map");
var QuadrinhoService = /** @class */ (function () {
    function QuadrinhoService(http) {
        this.http = http;
        this.PUBLIC_KEY = "dc005bd4fe7429cdfccbcfc756e79b7f";
        this.PRIVATE_KEY = "ec38d937988d5aedbea7b427414388679ec4d6da";
        this.BASE_URL = "https://gateway.marvel.com:443/v1/public";
    }
    QuadrinhoService.prototype.obterQuadrinhos = function (titulo, limit, offset) {
        if (titulo === void 0) { titulo = undefined; }
        if (limit === void 0) { limit = 20; }
        if (offset === void 0) { offset = 0; }
        var timestamp = Date.now();
        var hash = md5_1.Md5.hashStr(timestamp + this.PRIVATE_KEY + this.PUBLIC_KEY).toString();
        var params = new http_1.HttpParams()
            .set('limit', String(limit))
            .set('offset', String(offset))
            .set('ts', String(timestamp))
            .set('hash', String(hash))
            .set('apikey', String(this.PUBLIC_KEY));
        if (titulo) {
            params = params.set('titleStartsWith', titulo);
        }
        return this.http.get(this.BASE_URL + "/comics", { params: params });
    };
    QuadrinhoService.prototype.obterQuadrinho = function (codigo) {
        var timestamp = Date.now();
        var hash = md5_1.Md5.hashStr(timestamp + this.PRIVATE_KEY + this.PUBLIC_KEY).toString();
        return this.http.get(this.BASE_URL + "/comics/" + codigo + "&ts=" + timestamp + "&hash=" + hash + "&apikey=" + this.PUBLIC_KEY).map(function (result) {
            return result.data.count > 0 ? result.data.results[0] : undefined;
        });
    };
    QuadrinhoService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [http_1.HttpClient])
    ], QuadrinhoService);
    return QuadrinhoService;
}());
exports.QuadrinhoService = QuadrinhoService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVhZHJpbmhvLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJxdWFkcmluaG8uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUEyQztBQUMzQyw2Q0FBOEQ7QUFFOUQsdUNBQXFDO0FBR3JDLGlDQUErQjtBQUcvQjtJQU1FLDBCQUFvQixJQUFnQjtRQUFoQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBSjVCLGVBQVUsR0FBVyxrQ0FBa0MsQ0FBQztRQUN4RCxnQkFBVyxHQUFXLDBDQUEwQyxDQUFDO1FBQ2pFLGFBQVEsR0FBVywwQ0FBMEMsQ0FBQTtJQUU3QixDQUFDO0lBRXpDLDBDQUFlLEdBQWYsVUFBZ0IsTUFBMEIsRUFBRSxLQUFpQixFQUFFLE1BQWtCO1FBQWpFLHVCQUFBLEVBQUEsa0JBQTBCO1FBQUUsc0JBQUEsRUFBQSxVQUFpQjtRQUFFLHVCQUFBLEVBQUEsVUFBa0I7UUFDL0UsSUFBTSxTQUFTLEdBQVcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ3JDLElBQU0sSUFBSSxHQUFXLFNBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzVGLElBQUksTUFBTSxHQUFHLElBQUksaUJBQVUsRUFBRTthQUN4QixHQUFHLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUMzQixHQUFHLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUM3QixHQUFHLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUM1QixHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUN6QixHQUFHLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUd4QyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ1QsTUFBTSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDbkQsQ0FBQztRQUdMLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBZSxJQUFJLENBQUMsUUFBUSxZQUFTLEVBQUUsRUFBQyxNQUFNLEVBQUUsTUFBTSxFQUFDLENBQUMsQ0FBQztJQUNqRixDQUFDO0lBRUMseUNBQWMsR0FBZCxVQUFlLE1BQWM7UUFDM0IsSUFBTSxTQUFTLEdBQVcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ3JDLElBQU0sSUFBSSxHQUFXLFNBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzVGLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBZSxJQUFJLENBQUMsUUFBUSxnQkFBVyxNQUFNLFlBQU8sU0FBUyxjQUFTLElBQUksZ0JBQVcsSUFBSSxDQUFDLFVBQVksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLE1BQU07WUFDbEksTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUN0RSxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFqQ1ksZ0JBQWdCO1FBRDVCLGlCQUFVLEVBQUU7eUNBT2UsaUJBQVU7T0FOekIsZ0JBQWdCLENBb0M1QjtJQUFELHVCQUFDO0NBQUEsQUFwQ0QsSUFvQ0M7QUFwQ1ksNENBQWdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cFBhcmFtcyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL09ic2VydmFibGUnO1xuaW1wb3J0IHsgTWQ1IH0gZnJvbSAndHMtbWQ1L2Rpc3QvbWQ1J1xuaW1wb3J0IHsgQ29taWNEYXRhIH0gZnJvbSAnLi4vbW9kZWwvbWFydmVsJztcbmltcG9ydCB7IENvbWljIH0gZnJvbSAnLi4vbW9kZWwvbWFydmVsLyc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL21hcCc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBRdWFkcmluaG9TZXJ2aWNlIHtcblxuICBwcml2YXRlIFBVQkxJQ19LRVk6IHN0cmluZyA9IFwiZGMwMDViZDRmZTc0MjljZGZjY2JjZmM3NTZlNzliN2ZcIjtcbiAgcHJpdmF0ZSBQUklWQVRFX0tFWTogc3RyaW5nID0gXCJlYzM4ZDkzNzk4OGQ1YWVkYmVhN2I0Mjc0MTQzODg2NzllYzRkNmRhXCI7XG4gIHByaXZhdGUgQkFTRV9VUkw6IHN0cmluZyA9IFwiaHR0cHM6Ly9nYXRld2F5Lm1hcnZlbC5jb206NDQzL3YxL3B1YmxpY1wiXG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7IH1cblxuICBvYnRlclF1YWRyaW5ob3ModGl0dWxvOiBzdHJpbmcgPSB1bmRlZmluZWQsIGxpbWl0Om51bWJlciA9IDIwLCBvZmZzZXQ6IG51bWJlciA9IDApOiBPYnNlcnZhYmxlPENvbWljRGF0YT4ge1xuICAgIGNvbnN0IHRpbWVzdGFtcDogbnVtYmVyID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBoYXNoOiBzdHJpbmcgPSBNZDUuaGFzaFN0cih0aW1lc3RhbXAgKyB0aGlzLlBSSVZBVEVfS0VZICsgdGhpcy5QVUJMSUNfS0VZKS50b1N0cmluZygpO1xuICAgIGxldCBwYXJhbXMgPSBuZXcgSHR0cFBhcmFtcygpXG4gICAgICAgIC5zZXQoJ2xpbWl0JywgU3RyaW5nKGxpbWl0KSlcbiAgICAgICAgLnNldCgnb2Zmc2V0JywgU3RyaW5nKG9mZnNldCkpXG4gICAgICAgIC5zZXQoJ3RzJywgU3RyaW5nKHRpbWVzdGFtcCkpXG4gICAgICAgIC5zZXQoJ2hhc2gnLCBTdHJpbmcoaGFzaCkpXG4gICAgICAgIC5zZXQoJ2FwaWtleScsIFN0cmluZyh0aGlzLlBVQkxJQ19LRVkpKTtcbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICBpZiAodGl0dWxvKSB7XG4gICAgICAgICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCd0aXRsZVN0YXJ0c1dpdGgnLCB0aXR1bG8pO1xuICAgICAgICB9XG5cblxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PENvbWljRGF0YT4oYCR7dGhpcy5CQVNFX1VSTH0vY29taWNzYCwge3BhcmFtczogcGFyYW1zfSk7XG59XG5cbiAgb2J0ZXJRdWFkcmluaG8oY29kaWdvOiBudW1iZXIpOiBPYnNlcnZhYmxlPENvbWljPiB7XG4gICAgY29uc3QgdGltZXN0YW1wOiBudW1iZXIgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGhhc2g6IHN0cmluZyA9IE1kNS5oYXNoU3RyKHRpbWVzdGFtcCArIHRoaXMuUFJJVkFURV9LRVkgKyB0aGlzLlBVQkxJQ19LRVkpLnRvU3RyaW5nKCk7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8Q29taWNEYXRhPihgJHt0aGlzLkJBU0VfVVJMfS9jb21pY3MvJHtjb2RpZ299JnRzPSR7dGltZXN0YW1wfSZoYXNoPSR7aGFzaH0mYXBpa2V5PSR7dGhpcy5QVUJMSUNfS0VZfWApLm1hcChyZXN1bHQgPT4ge1xuICAgICAgICByZXR1cm4gcmVzdWx0LmRhdGEuY291bnQgPiAwID8gcmVzdWx0LmRhdGEucmVzdWx0c1swXSA6IHVuZGVmaW5lZDtcbiAgICB9KTtcbn1cblxuXG59ICJdfQ==